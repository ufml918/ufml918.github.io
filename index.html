<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>è‰¾ç‘å…‹æ„›çš„å¤§å†’éšª â€“ CYOA</title>
  <style>
    :root { --bg:#0f172a; --panel:#111827; --card:#0b1220; --ink:#e5e7eb; --muted:#94a3b8; --accent:#38bdf8; --good:#22c55e; --bad:#ef4444; }
    html,body{height:100%}
    body{margin:0; font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Inter,Arial; background:radial-gradient(1000px 800px at 10% -10%, #1f2937 0, #0b1020 40%, #050812 100%); color:var(--ink)}
    .wrap{max-width:960px;margin:32px auto;padding:0 16px}
    header{display:flex;align-items:center;justify-content:center;gap:12px;margin-bottom:16px}
    h1{font-size:clamp(1.2rem,3.2vw,1.8rem);margin:0;font-weight:800;letter-spacing:.3px}
    .panel{background:linear-gradient(180deg,#0b1324,#070a14);border:1px solid #1f2937;border-radius:18px;box-shadow:0 10px 30px rgba(0,0,0,.35);padding:20px}
    .center{display:flex;flex-direction:column;align-items:center;justify-content:center;gap:16px;text-align:center}
    .bigplay{font-size:clamp(1rem,2.6vw,1.3rem);padding:16px 22px;border-radius:999px;border:1px solid #0ea5e9;background:linear-gradient(180deg,#0284c7,#0369a1);color:white;font-weight:800;cursor:pointer}
    .bigplay:hover{filter:brightness(1.05)}
    .player{display:flex;flex-direction:column;gap:12px}
    .card{background:linear-gradient(180deg,#0a1428,#091124);border:1px solid #1f2937;border-radius:18px;padding:20px}
    .title{font-size:1.1rem;font-weight:800;margin:0 0 6px}
    .text{white-space:pre-wrap;line-height:1.75}
    .choices{display:flex;flex-direction:column;gap:10px;margin-top:12px}
    .choice{display:block;text-align:left}
    button{appearance:none;border:1px solid #1f2937;background:linear-gradient(180deg,#0c162a,#08101f);color:var(--ink);padding:10px 12px;border-radius:12px;font-weight:700;cursor:pointer}
    button:hover{border-color:#334155}
    .toolbar{display:flex;justify-content:space-between;align-items:center;gap:8px;margin-bottom:8px}
    .breadcrumbs{display:flex;flex-wrap:wrap;gap:6px}
    .crumb{font-size:.8rem;color:var(--muted);background:#0b1220;border:1px dashed #1f2937;border-radius:999px;padding:4px 8px}
    /* IMPORTANT: make hidden always win over other display rules */
    .hidden{display:none !important}
    .img-wrap{border-radius:14px;overflow:hidden;border:1px solid #1f2937;margin-bottom:10px}
    img{max-width:100%;display:block}

    /* Ending styles */
    .good-banner{display:flex;flex-direction:column;align-items:center;gap:14px;margin-top:14px}
    .good-btn{font-size:clamp(1.1rem,3.5vw,1.6rem);padding:18px 26px;border-radius:999px;border:2px solid #16a34a;background:linear-gradient(180deg,#22c55e,#16a34a);color:#052e16;font-weight:900;cursor:default}
    .good-btn:disabled{opacity:1}
    .restart-btn{border-color:#b91c1c;background:linear-gradient(180deg,#ef4444,#b91c1c);color:#fff;font-weight:900}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1>ğŸ‚ è‰¾ç‘å…‹æ„›çš„å¤§å†’éšª</h1>
    </header>

    <!-- Landing Screen -->
    <div id="landing" class="panel center">
      <p class="muted">Click to begin the story</p>
      <button id="play" class="bigplay">â–¶ é–‹å§‹éŠæˆ² (Play)</button>
    </div>

    <!-- Player -->
    <div id="player" class="player hidden">
      <div class="toolbar">
        <div class="breadcrumbs" id="crumbs"></div>
        <div>
          <button id="back">â† ä¸Šä¸€æ­¥</button>
          <button id="restart">âŸ² é‡æ–°é–‹å§‹</button>
        </div>
      </div>
      <div class="card">
        <div class="img-wrap hidden" id="img-wrap"><img id="node-img" alt=""/></div>
        <h3 class="title" id="story-title"></h3>
        <div class="text" id="node-text"></div>
        <div class="choices" id="choices"></div>
        <div class="good-banner hidden" id="good-banner">
          <img id="good-img" alt="Happy ending image"/>
          <button class="good-btn" id="good-btn" disabled>Happy birthday Eric Yu ğŸ‚</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    // ====== Configuration ======
    const GOOD_END_IMAGE_URL = "./img/1.jpg";

    // Embedded story (fixed; no external input)
    const STORY = {
      "title": "è‰¾ç‘å…‹æ„›çš„å¤§å†’éšª",
      "start": "Setting story(L0)",
      "nodes": {
        "Setting story(L0)": {
          "text": "å°ä½ ä¾†èªªï¼Œä»Šå¤©æ˜¯å€‹é‡è¦çš„æ—¥å­ï¼šä½ å°‡è¦èˆ‡ä½ æš—æˆ€å¤šå¹´çš„å¥³åŒå­¸å‘Šç™½ã€‚ä½ èµ°å‘èˆ‡å¥¹ç´„å¥½çš„åœ°é»æº–å‚™å‘Šç™½ã€‚",
          "choices": [
            {"label": "æ«»èŠ±æ¨¹ä¸‹", "to": "sakura-BE1"},
            {"label": "å¡åº—", "to": "card store"}
          ]
        },
        "sakura-BE1": {
          "text": "ä¸çŸ¥éäº†å¤šä¹…ï¼Œæ¨¹ä¸‹ä»ç„¶åªæœ‰ä½ ä¸€äººï¼Œä½ è¢«æ”¾é³¥äº†ã€‚",
          "end": true,
          "endingType": "bad"
        },
        "card store": {
          "text": "ä½ æŠµé”äº†å¡åº—ï¼Œçœ‹åˆ°äº†ä½ æš—æˆ€è¨±ä¹…çš„å¥³å­©ç«™åœ¨é–€å£ï¼Œä½ è‡‰ä¸Šæ›è‘—å¾®ç¬‘ï¼Œå‘å¥¹æ‰“æ‹›å‘¼ã€‚",
          "choices": [
            {"label": "å—¨", "to": "not polite"},
            {"label": "My lovely lady, you brighten up the place just by being here.", "to": "polite-BE2"}
          ]
        },
        "polite-BE2": {
          "text": "ã€Œä½ æ˜æ˜çŸ¥é“æˆ‘è‹±æ–‡ä¸å¥½ï¼Œä½ æ˜¯çœ‹ä¸èµ·æˆ‘å—ï¼Ÿã€ï¼Œå¥¹æ‰“äº†ä½ ä¸€å·´æŒå¾Œé›¢é–‹äº†ã€‚",
          "end": true,
          "endingType": "bad"
        },
        "not polite": {
          "text": "å¥¹å°ä½ æ®äº†æ®æ‰‹ï¼Œèªªå‡ºäº†ä½ çš„åå­—ã€‚",
          "choices": [
            {"label": "ä½™æ¬Šæ†", "to": "yes"},
            {"label": "ä¸æ˜¯ä½™æ¬Šæ†", "to": "wtfru-BE3"}
          ]
        },
        "yes": {
          "text": "ä½ ä¹Ÿç”œè†©åœ°èªªå‡ºäº†å¥¹çš„åå­—...",
          "choices": [
            {"label": "Tina", "to": "Tina"},
            {"label": "Ina", "to": "Ina"},
            {"label": "å¦ä¸€å€‹ Eric", "to": "BL-BE4"}
          ]
        },
        "wtfru-BE3": {
          "text": "æ­¤æ™‚å¡åº—è€é—†èµ°å‡ºä¾†ï¼Œæ‰“äº†ä½ ä¸€å·´æŒï¼Œèªªï¼šã€Œä½ ä»–åª½æ˜¯èª°ï¼Œå¿«çµ¦æˆ‘æ»¾ã€‚ã€",
          "end": true,
          "endingType": "bad"
        },
        "Tina": {
          "text": "Tina: ä»€éº¼éƒ½ä¸è¦å•ï¼Œè·Ÿæˆ‘å›å°å—å§ã€‚",
          "choices": [
            {"label": "è·Ÿå¥¹å›å°å—", "to": "My new home-BE5"},
            {"label": "è·Ÿå¥¹å›å°å—", "to": "My new home-BE5"}
          ]
        },
        "Ina": {
          "text": "å¥¹å°è‘—ä½ ç¬‘äº†ç¬‘ï¼Œèªªï¼šã€Œä»Šå¤©æ‰¾æˆ‘ä¾†æœ‰ä»€éº¼äº‹å—ï¼Ÿã€",
          "choices": [
            {"label": "ç›´æ¥å‘Šç™½", "to": "Failure-BE6"},
            {"label": "æ±ºé¬¥ï¼ï¼ï¼", "to": "Duel"}
          ]
        },
        "BL-BE4": {
          "text": "å¦ä¸€å€‹Eric: ä»–é»˜é»˜åœ°èµ°å‘ä½ ï¼Œçœ¼ä¸­æ³›è‘—æ·šã€‚ã€Œæˆ‘å–œæ­¡ä½ ã€‚ã€ä»–æ‚„æ‚„åœ°èªªï¼Œæ­¤æ™‚ï¼Œä½ ä¸€è¨€ä¸ç™¼çš„å°‡ä»–æŠ±ç·Šï¼Œèªªï¼šã€Œæˆ‘ä¹Ÿæ˜¯ã€‚ã€é€™ä¸€åˆ»ï¼Œä½ å€‘å…©å€‹å¿ƒä¸­å¹¸ç¦æ»¿æº¢ï¼Œæœªä¾†å……æ»¿äº†å…‰æ˜ã€‚(ä¸–ä¸Šå«Ericçš„å¤šå¦‚ç‰›æ¯›ï¼Œçµ•å°ä¸æ˜¯ä½ æƒ³çš„é‚£å€‹ã€‚",
          "end": true,
          "endingType": "bad"
        },
        "My new home-BE5": {
          "text": "å¾æ­¤ä»¥å¾Œï¼Œä½ å’ŒTinaéä¸Šäº†å¹¸ç¦çš„äººç”Ÿ",
          "end": true,
          "endingType": "bad"
        },
        "Failure-BE6": {
          "text": "Ina:ã€Œå°ä¸èµ·ï¼Œæˆ‘å°ä½ æ²’é‚£ç¨®æ„æ€ï¼Œä½ æ˜¯å€‹å¥½äººã€‚ã€ **ä½ è¢«æ‹’çµ•äº†**",
          "end": true,
          "endingType": "bad"
        },
        "Duel": {
          "text": "ã€Œä¾†å ‚å ‚æ­£æ­£çš„æ±ºé¬¥å§ï¼æˆ‘è´äº†å¦³å°±å¾—åšæˆ‘çš„è€å©†ï¼ã€ä½ æ…·æ…¨æ¿€æ˜‚çš„èªªã€‚æ­¤æ™‚ä½ æ‹¿å‡ºä½ çš„æ­¦å™¨ã€‚",
          "choices": [
            {"label": "é•·åŠ", "to": "loser-BE7"},
            {"label": "å¼“ç®­", "to": "loser-BE7"},
            {"label": "é’çœ¼ç™½é¾ç‰Œçµ„", "to": "mystery person"}
          ]
        },
        "loser-BE7": {
          "text": "ä½ è¢«Inaçš„è§¸é¬šè¼•æ˜“åœ°æ‰“æ•—äº†ï¼Œä½ çš„å°Šåš´è¢«è¸è¸ï¼Œä½ å†ä¹Ÿç«™ä¸èµ·ä¾†äº†",
          "end": true,
          "endingType": "bad"
        },
        "mystery person": {
          "text": "ä½ å¬å–šçš„é’çœ¼ç™½é¾èˆ‡Inaæ‰“çš„ä¸åˆ†è»’è¼Šï¼Œæœ¬ä»¥ç‚ºæœ‰æ©Ÿæœƒç²å‹ï¼Œä¸å¹¸çš„æ˜¯ï¼Œç«™åœ¨ä¸€æ—çš„ä½ è¢«Inaçš„è§¸é¬šæ³¢åŠï¼Œç«‹å³æšˆäº†éå»ï¼Œé†’ä¾†å¾Œï¼Œä½ ç™¼ç¾ä½ åœ¨é›²å±¤ä¹‹ä¸Šï¼Œå‘¨åœæœµæœµçš„ç™½é›²ã€‚è€Œä½ çš„é¢å‰æœ‰ä¸€ä½ç¥ç§˜äººç‰©ï¼Œä»–æ˜¯...",
          "choices": [
            {"label": "ç­‰ç­‰ï¼Œé€™åˆ°åº•æ˜¯èª°ï¼Ÿ", "to": "betral-BE8"},
            {"label": "ä¸¹å°¼ç¥çˆ¶", "to": "Danny"}
          ]
        },
        "betral-BE8": {
          "text": "ã€Œæˆ‘ç•¶æ™‚å¤©å¤©ç…§é¡§ä½ ï¼Œçµ¦ä½ åƒé£¯ï¼Œä½ ç«Ÿç„¶é€£æˆ‘éƒ½ä¸èªå¾—ï¼Œå¿˜æ©è² ç¾©çš„å°å­ï¼Œä¸‹åœ°ç„å»å§ï¼ã€‘",
          "end": true,
          "endingType": "bad"
        },
        "Danny": {
          "text": "ã€Œæ²’éŒ¯ï¼Œæˆ‘çš„å­©å­ï¼Œæˆ‘å¯ä»¥å¯¦ç¾ä½ ä¸€å€‹é¡˜æœ›ï¼Œä½ è¦ä»€éº¼ï¼Ÿã€",
          "choices": [
            {"label": "æˆ‘è¦Inaç•¶æˆ‘è€å©†", "to": "what a dreamer-BE9"},
            {"label": "æˆ‘è¦å»èŸ¹å ¡ç‹åƒèŸ¹å ¡", "to": "Krusty Krab"}
          ]
        },
        "what a dreamer-BE9": {
          "text": "ç¥çˆ¶èªª:ã€Œä½ å°Tinaçš„æ„›å¯¦åœ¨æ˜¯å¤ªä»¤äººå‹•å®¹äº†ï¼Œæˆ‘é¦¬ä¸Šé€ä½ å»å°å—ï¼ï¼ã€ä½ :ã€Œç­‰ç­‰ç¥çˆ¶ï¼Œä½ è½éŒ¯äº†ï¼Œæˆ‘æ˜¯èªª...ã€ä¸ç­‰ä½ èªªå®Œï¼Œä½ å°±å·²ç¶“è¢«é€åˆ°å°å—äº†ã€‚å¾æ­¤ä¹‹å¾Œèˆ‡Tinaéè‘—å¹¸ç¦çš„ç”Ÿæ´»ã€‚",
          "end": true,
          "endingType": "bad"
        },
        "Krusty Krab": {
          "text": "ä½ è¢«ç¥çˆ¶å‚³é€åˆ°äº†èŸ¹å ¡ç‹...? ç­‰ç­‰ï¼Œé€™è£¡å¥½åƒæ˜¯æˆ‘å€‘çš„èŸ¹å ¡ç‹ã€‚ æ­¤æ™‚ï¼Œç« é­šå“¥èµ°åˆ°ä½ çš„æ¡Œé‚Šï¼Œèªª:ã€Œæ­¡è¿ä¾†åˆ°æˆ‘å€‘çš„èŸ¹å ¡ç‹ï¼Œè«‹å•è¦é»äº›ä»€éº¼ï¼Ÿã€‘",
          "choices": [
            {"label": "ä»Šå¤©æ˜¯æˆ‘ç”Ÿæ—¥", "to": "HBD Eric"},
            {"label": "ä¾†ä¸€ä»½ç¾å‘³èŸ¹å ¡è¬è¬", "to": "at least you have something to eat-BE10"}
          ]
        },
        "at least you have something to eat-BE10": {
          "text": "ä½ åƒäº†ç¾å‘³èŸ¹å ¡ã€ç‚¸æµ·è‰ã€å–è‘—æµ·è‰æ±ï¼Œä¸¦æ»¿è¶³çš„å›å®¶äº†ï¼Œä½†ç¸½æ„Ÿè¦ºç¼ºå°‘äº†äº›ä»€éº¼ã€‚",
          "end": true,
          "endingType": "bad"
        },
        "HBD Eric": {
          "text": "å¯ä»¥å”±æˆ‘å€‘çš„èŸ¹å ¡ç‹çš„ç”Ÿæ—¥å¿«æ¨‚æ­Œçµ¦æˆ‘çš„å°å¯¶è²è½å—ï¼Ÿ",
          "end": true,
          "endingType": "good",
          "image": "__GOOD_END_PLACEHOLDER__"
        }
      }
    };

    // ====== App ======
    const $id = (id)=>document.getElementById(id);
    const state = { story: STORY, current: null, history: [] };

    function setMode(mode){
      if(mode==='play'){
        $id('landing').classList.add('hidden');
        $id('player').classList.remove('hidden');
      } else {
        $id('landing').classList.remove('hidden');
        $id('player').classList.add('hidden');
      }
    }

    function render(){
      const node = state.story.nodes[state.current];
      $id('story-title').textContent = state.story.title;
      $id('node-text').textContent = node.text;

      // Reset banners/choices each render
      $id('good-banner').classList.add('hidden');
      $id('choices').innerHTML = '';

      // node image (non-ending)
      if(node.image && node.endingType !== 'good'){
        $id('img-wrap').classList.remove('hidden');
        $id('node-img').src = node.image;
      } else {
        $id('img-wrap').classList.add('hidden');
        $id('node-img').removeAttribute('src');
      }

      // breadcrumbs
      const crumbs = state.history.concat(state.current).map(id=>`<span class="crumb">${id}</span>`).join('');
      $id('crumbs').innerHTML = crumbs;

      const isEnd = !!node.end;
      if(isEnd){
        if(node.endingType === 'bad'){
          const b = document.createElement('button');
          b.textContent = 'ğŸ”„ é‡æ–°é–‹å§‹ (Restart)';
          b.className='restart-btn';
          b.onclick = restart;
          $id('choices').appendChild(b);
        } else if(node.endingType === 'good'){
          // GOOD ending: show image + big disabled button
          const url = node.image && node.image !== '__GOOD_END_PLACEHOLDER__' ? node.image : GOOD_END_IMAGE_URL;
          if(url){
            $id('good-img').src = url;
            $id('good-img').style.maxHeight = '50vh';
          }
          $id('good-banner').classList.remove('hidden');
        } else {
          // default end behavior (restart)
          const b = document.createElement('button');
          b.textContent = 'ğŸ‰ å®Œçµ â€” é‡æ–°é–‹å§‹';
          b.onclick = restart;
          $id('choices').appendChild(b);
        }
      } else {
        for(const c of (node.choices||[])){
          const btn = document.createElement('button');
          btn.className='choice';
          btn.textContent = 'â€¢ ' + c.label;
          btn.onclick = () => go(c.to);
          $id('choices').appendChild(btn);
        }
      }
    }

    function go(nextId){
      state.history.push(state.current);
      state.current = nextId;
      render();
    }

    function back(){
      if(state.history.length===0) return;
      state.current = state.history.pop();
      render();
    }

    function restart(){
      state.history = [];
      state.current = state.story.start;
      render();
    }

    // Wire up
    $id('play').onclick = ()=>{ state.current = state.story.start; setMode('play'); render(); };
    $id('back').onclick = back;
    $id('restart').onclick = restart;

    // Swap in GOOD image placeholder
    (function applyGoodImage(){
      const goodNode = state.story.nodes['HBD Eric'];
      if(goodNode && goodNode.image === '__GOOD_END_PLACEHOLDER__'){
        goodNode.image = GOOD_END_IMAGE_URL;
      }
    })();
  </script>
</body>
</html>
